import{u as $}from"./vue.f36acd1f.ee4e5a38.js";import{_ as L,a as T,F as D,s as V,f as F}from"./Popup.vue.9460c2dc.js";import P from"./icon-user-plus.96f2d2a7.js";import{P as B}from"./PopupContainer.54ccd51c.js";import{u as g}from"./useData.cb5eebf3.js";import{f as v,o as f,c as C,a as r,t as j,h as w,b as a,u as l,r as d,i as E,g as x,F as N,w as _,j as S}from"./entry.676b6978.js";import q from"./icon-edit.257ea2b2.js";import K from"./icon-trash.903a0f0f.js";import"./nuxt-link.6c446591.js";import"./icon-close.c49ccc36.js";import"./cookie.5691c368.js";const O={class:"flex items-center px-4 py-3 bg-dark-light/10 odd:bg-white hover:bg-dark-light/20 cursor-pointer rounded"},U={class:"w-10/12"},z={class:"w-2/12 flex items-center justify-end"},H=["onClick"],M=["onClick"],R=v({__name:"InitiativeTypesListItem",props:{item:Object},emits:["click","delete"],setup(m,{emit:n}){const s=m,t=n,i=()=>{t("click",s.item)},c=()=>{var o;confirm(`Вы действительно хотите удалить тип инициативы «${(o=s.item)==null?void 0:o.name}»`)&&t("delete",s.item)};return(o,u)=>(f(),C("div",O,[r("div",U,j(m.item.name),1),r("div",z,[r("a",{href:"",class:"block w-5 h-5 mx-1 text-dark-main hover:text-main",onClick:w(i,["prevent"])},[a(l(q),{filled:""})],8,H),r("a",{href:"",class:"block w-5 h-5 mx-1 text-dark-main hover:text-main",onClick:w(c,["prevent"])},[a(l(K),{filled:""})],8,M)])]))}}),A=v({__name:"InitiativeTypesList",emits:["click","delete"],setup(m,{expose:n,emit:s}){const t=g(),i=d(t.types),c=s,o=p=>{c("click",p)},u=p=>{c("delete",p)};return n({update:()=>{i.value=t.types}}),(p,y)=>(f(!0),C(N,null,E(l(i),e=>(f(),x(R,{item:e,key:`types${e.id}`,onClick:o,onDelete:u},null,8,["item"]))),128))}}),G={class:"w-7/12 min-w-[520px]"},J={class:"w-full text-center"},Q=r("span",{class:"hidden md:inline"},"Добавление типа инициативы",-1),W=v({__name:"InitiativeTypes",setup(m){const n=d("Добавление типа инициативы"),s=d(),t=d(""),i=d(void 0),c=g(),o=d(),u=e=>{n.value="Добавление типа инициативы",e!=null&&e.id&&(n.value="Изменение наименования типа",t.value=(e==null?void 0:e.name)||"",i.value=(e==null?void 0:e.id)||void 0),s.value.show()},h=()=>{s.value.hide(),t.value="",i.value=void 0},p=async()=>{c.updateInitiativeTypes({id:i.value||void 0,name:t.value}).then(e=>{if(e){if(e!=null&&e.errors)return V("types_form",[],e.errors);o.value.update(),h()}}).catch(e=>{console.log(e)})},y=async e=>{await c.deleteInitiativeTypes(e).then(()=>o.value.update())};return(e,k)=>{const b=F;return f(),x(l(D),{"config-file":"true"},{default:_(()=>[r("div",G,[r("div",J,[a(L,{class:"inline-flex items-center bg-main text-white hover:bg-main-light py-3 px-6 w-auto mx-auto mb-8",title:"Добавить тип инициативы",onClick:u},{default:_(()=>[a(l(P),{class:"block text-white w-6 h-6 mr-2",filled:""}),Q]),_:1})]),a(A,{onClick:u,onDelete:y,ref_key:"typesList",ref:o},null,512),a(B,{ref_key:"popup",ref:s,onClose:h},{default:_(()=>[a(T,{class:"bg-gray-light/60 w-full min-w-[300px] max-w-[500px] max-h-full pb-0",title:l(n),onClose:h},{default:_(()=>[a(b,{id:"ownership_form",type:"form","submit-label":l(i)?"Сохранить":"Добавить",config:{validationVisibility:"submit"},onSubmit:p},{default:_(()=>[a(b,{type:"text",name:"name_short",id:"name_short",label:"Наименование",placeholder:"Наименование типа",modelValue:l(t),"onUpdate:modelValue":k[0]||(k[0]=I=>S(t)?t.value=I:null),validation:"required|length:5|ccontains_alpha_spaces","validation-visibility":"live","validation-messages":{length:"Длина наименование должна быть не менее 5 символов",required:"Необходимо указать наименование",contains_alpha_spaces:"Наименование должно состоять из букв и пробелов"}},null,8,["modelValue"])]),_:1},8,["submit-label"])]),_:1},8,["title"])]),_:1},512)])]),_:1})}}}),ce=v({__name:"index",setup(m){return $({title:"АГА. Список типов"}),(n,s)=>(f(),x(W))}});export{ce as default};
