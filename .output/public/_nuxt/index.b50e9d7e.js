import{u as D}from"./vue.f36acd1f.ee4e5a38.js";import{_ as F,a as N,F as P,s as S,f as q}from"./Popup.vue.9460c2dc.js";import{u as A}from"./useData.cb5eebf3.js";import{f as y,o as p,c as I,a as u,g,u as i,d as B,t as V,h as $,b as l,r as c,i as U,F as j,w as h,j as C}from"./entry.676b6978.js";import E from"./icon-edit.257ea2b2.js";import K from"./icon-trash.903a0f0f.js";import z from"./icon-checkbox.fea6b3a6.js";import O from"./icon-square.45dde8bf.js";import T from"./icon-user-plus.96f2d2a7.js";import{P as H}from"./PopupContainer.54ccd51c.js";import{s as M}from"./slugify.7011283c.js";import"./nuxt-link.6c446591.js";import"./icon-close.c49ccc36.js";import"./cookie.5691c368.js";const G={class:"flex items-center px-4 py-3 bg-dark-light/10 odd:bg-white hover:bg-dark-light/20 cursor-pointer rounded"},J={class:"flex items-center w-6/12"},Q={class:"w-4/12"},W={class:"w-2/12 flex items-center justify-end"},X=["onClick"],Y=["onClick"],Z=y({__name:"RegionsListItem",props:{item:Object},emits:["click","delete"],setup(d,{emit:r}){const a=d,t=r,o=()=>{t("click",a.item)},s=()=>{var n;confirm(`Вы действительно хотите удалить регион «${(n=a.item)==null?void 0:n.name}»`)&&t("delete",a.item)};return(n,v)=>(p(),I("div",G,[u("div",J,[d.item.isActive?(p(),g(i(z),{key:0,class:"w-5 h-5 mr-1",filled:""})):(p(),g(i(O),{key:1,class:"w-5 h-5 mr-1",filled:""})),B(" "+V(d.item.name),1)]),u("div",Q,V(d.item.slug),1),u("div",W,[u("a",{href:"",class:"block w-5 h-5 mx-1 text-dark-main hover:text-main",onClick:$(o,["prevent"])},[l(i(E),{filled:""})],8,X),u("a",{href:"",class:"block w-5 h-5 mx-1 text-dark-main hover:text-main",onClick:$(s,["prevent"])},[l(i(K),{filled:""})],8,Y)])]))}}),ee=y({__name:"RegionsList",emits:["click","delete"],setup(d,{expose:r,emit:a}){const t=A(),o=c(t.regions),s=a,n=m=>{s("click",m)},v=m=>{s("delete",m)};return r({update:()=>{o.value=t.regions}}),(m,k)=>(p(!0),I(j,null,U(i(o),b=>(p(),g(Z,{item:b,key:b.id,onClick:n,onDelete:v},null,8,["item"]))),128))}}),te={class:"w-7/12 min-w-[520px]"},oe={class:"w-full text-center"},ie=u("span",{class:"hidden md:inline"},"Добавление региона",-1),se=y({__name:"Regions",setup(d){const r=c("Добавить регион"),a=c(),t=c(""),o=c(""),s=c(!1),n=c(void 0),v=A(),x=c(),m=e=>{r.value="Добавить регион",e!=null&&e.id&&(r.value="Изменение данных региона",t.value=(e==null?void 0:e.name)||"",o.value=(e==null?void 0:e.slug)||"",s.value=(e==null?void 0:e.isActive)||!1,n.value=(e==null?void 0:e.id)||void 0),a.value.show()},k=()=>{a.value.hide(),t.value="",o.value="",s.value=!1,n.value=void 0},b=async()=>{v.updateRegion({id:n.value||void 0,name:t.value,slug:o.value,isActive:s.value}).then(e=>{if(e){if(e!=null&&e.errors)return S("regions_form",[],e.errors);x.value.update(),k()}}).catch(e=>{console.log(e)})},L=async e=>{await v.deleteRegion(e).then(()=>x.value.update())},R=()=>{o.value=M(t.value)};return(e,f)=>{const w=q;return p(),g(i(P),{"config-file":"true"},{default:h(()=>[u("div",te,[u("div",oe,[l(F,{class:"inline-flex items-center bg-main text-white hover:bg-main-light py-3 px-6 w-auto mx-auto mb-8",title:"Добавить регион",onClick:m},{default:h(()=>[l(i(T),{class:"block text-white w-6 h-6 mr-2",filled:""}),ie]),_:1})]),l(ee,{onClick:m,onDelete:L,ref_key:"regionsList",ref:x},null,512),l(H,{ref_key:"popup",ref:a,onClose:k},{default:h(()=>[l(N,{class:"bg-gray-light/60 w-full min-w-[300px] max-w-[500px] max-h-full pb-0",title:i(r),onClose:k},{default:h(()=>[l(w,{id:"regions_form",type:"form","submit-label":i(n)?"Сохранить":"Добавить",config:{validationVisibility:"submit"},onSubmit:b},{default:h(()=>[l(w,{type:"text",name:"name",id:"name",label:"Название",placeholder:"Наименование региона",modelValue:i(t),"onUpdate:modelValue":f[0]||(f[0]=_=>C(t)?t.value=_:null),onKeyup:R,validation:"required|length:3|contains_alpha_spaces","validation-visibility":"live","validation-messages":{region_exists:"Указанный регион уже существует",length:"Длина наименование должна быть не менее 3 символов",required:"Необходимо указать наименование региона",name:"Наименование должно состоять из букв и пробелов"}},null,8,["modelValue"]),l(w,{type:"text",name:"slug",id:"slug",label:"Идентификатор",placeholder:"name_url_link",modelValue:i(o),"onUpdate:modelValue":f[1]||(f[1]=_=>C(o)?o.value=_:null),validation:"required|length:3|matches:/[0-9a-z_]/","validation-visibility":"live","validation-messages":{length:"Длина Идентификатора должна быть не менее 3 символов",required:"Необходимо указать Идентификатор",matches:"В написании Идентификатора допустимо использование символов английского алфавита и нижнего подчеркивания"}},null,8,["modelValue"]),l(w,{type:"checkbox",name:"isActive",id:"isActive",label:"Отображение региона на сайте",modelValue:i(s),"onUpdate:modelValue":f[2]||(f[2]=_=>C(s)?s.value=_:null)},null,8,["modelValue"])]),_:1},8,["submit-label"])]),_:1},8,["title"])]),_:1},512)])]),_:1})}}}),xe=y({__name:"index",setup(d){return D({title:"АГА. Настройка регионов"}),(r,a)=>(p(),g(se))}});export{xe as default};
