import{u as S}from"./vue.f36acd1f.ee4e5a38.js";import{_ as L,a as D,F as I,s as P,f as q}from"./Popup.vue.9460c2dc.js";import{u as V}from"./useData.cb5eebf3.js";import{f as w,o as h,c as O,a as u,t as C,h as F,b as a,u as l,r as d,i as B,g,F as N,w as _,j as $}from"./entry.676b6978.js";import j from"./icon-edit.257ea2b2.js";import E from"./icon-trash.903a0f0f.js";import U from"./icon-user-plus.96f2d2a7.js";import{P as K}from"./PopupContainer.54ccd51c.js";import"./nuxt-link.6c446591.js";import"./icon-close.c49ccc36.js";import"./cookie.5691c368.js";const z={class:"flex items-center px-4 py-3 bg-dark-light/10 odd:bg-white hover:bg-dark-light/20 cursor-pointer rounded"},H={class:"flex items-center w-2/12"},M={class:"w-8/12"},R={class:"w-2/12 flex items-center justify-end"},T=["onClick"],A=["onClick"],G=w({__name:"OwnershipListItem",props:{item:Object},emits:["click","delete"],setup(m,{emit:r}){const n=m,t=r,o=()=>{t("click",n.item)},s=()=>{var c,i;confirm(`Вы действительно хотите удалить форму собственности «${(c=n.item)==null?void 0:c.nameFull} (${(i=n.item)==null?void 0:i.nameShort})»`)&&t("delete",n.item)};return(c,i)=>(h(),O("div",z,[u("div",H,C(m.item.nameShort),1),u("div",M,C(m.item.nameFull),1),u("div",R,[u("a",{href:"",class:"block w-5 h-5 mx-1 text-dark-main hover:text-main",onClick:F(o,["prevent"])},[a(l(j),{filled:""})],8,T),u("a",{href:"",class:"block w-5 h-5 mx-1 text-dark-main hover:text-main",onClick:F(s,["prevent"])},[a(l(E),{filled:""})],8,A)])]))}}),J=w({__name:"OwnershipList",emits:["click","delete"],setup(m,{expose:r,emit:n}){const t=V(),o=d(t.ownership),s=n,c=p=>{s("click",p)},i=p=>{s("delete",p)};return r({update:()=>{o.value=t.ownership}}),(p,y)=>(h(!0),O(N,null,B(l(o),f=>(h(),g(G,{item:f,key:f.id,onClick:c,onDelete:i},null,8,["item"]))),128))}}),Q={class:"w-7/12 min-w-[520px]"},W={class:"w-full text-center"},X=u("span",{class:"hidden md:inline"},"Добавление формы собственности",-1),Y=w({__name:"Ownership",setup(m){const r=d("Добавить форму собственности"),n=d(),t=d(""),o=d(""),s=d(void 0),c=V(),i=d(),x=e=>{r.value="Добавить форму собственности",e!=null&&e.id&&(r.value="Изменение данных формы собственности",t.value=(e==null?void 0:e.nameShort)||"",o.value=(e==null?void 0:e.nameFull)||"",s.value=(e==null?void 0:e.id)||void 0),n.value.show()},p=()=>{n.value.hide(),t.value="",o.value="",s.value=void 0},y=async()=>{c.updateOwnership({id:s.value||void 0,nameShort:t.value,nameFull:o.value}).then(e=>{if(e){if(e!=null&&e.errors)return P("ownership_form",[],e.errors);i.value.update(),p()}}).catch(e=>{console.log(e)})},f=async e=>{await c.deleteOwnership(e).then(()=>i.value.update())};return(e,v)=>{const k=q;return h(),g(l(I),{"config-file":"true"},{default:_(()=>[u("div",Q,[u("div",W,[a(L,{class:"inline-flex items-center bg-main text-white hover:bg-main-light py-3 px-6 w-auto mx-auto mb-8",title:"Добавить регион",onClick:x},{default:_(()=>[a(l(U),{class:"block text-white w-6 h-6 mr-2",filled:""}),X]),_:1})]),a(J,{onClick:x,onDelete:f,ref_key:"ownershipList",ref:i},null,512),a(K,{ref_key:"popup",ref:n,onClose:p},{default:_(()=>[a(D,{class:"bg-gray-light/60 w-full min-w-[300px] max-w-[500px] max-h-full pb-0",title:l(r),onClose:p},{default:_(()=>[a(k,{id:"ownership_form",type:"form","submit-label":l(s)?"Сохранить":"Добавить",config:{validationVisibility:"submit"},onSubmit:y},{default:_(()=>[a(k,{type:"text",name:"name_short",id:"name_short",label:"Сокрашение",placeholder:"Сокращённое наименование",modelValue:l(t),"onUpdate:modelValue":v[0]||(v[0]=b=>$(t)?t.value=b:null),validation:"required|length:2|contains_alpha|contains_uppercase","validation-visibility":"live","validation-messages":{length:"Длина наименование должна быть не менее 3 символов",required:"Необходимо указать сокращённое название формы собственности",contains_alpha:"Наименование должно состоять из букв",contains_uppercase:"Наименование должно быть написано большими буквами"}},null,8,["modelValue"]),a(k,{type:"text",name:"name_full",id:"name_full",label:"Наименование",placeholder:"Полное наименование",modelValue:l(o),"onUpdate:modelValue":v[1]||(v[1]=b=>$(o)?o.value=b:null),validation:"required|length:5|contains_alpha_spaces","validation-visibility":"live","validation-messages":{length:"Длина Наименования должна быть не менее 5 символов",required:"Необходимо указать Наименование",contains_alpha_spaces:"В написании наименования допустимо использование букв и пробелов"}},null,8,["modelValue"])]),_:1},8,["submit-label"])]),_:1},8,["title"])]),_:1},512)])]),_:1})}}}),pe=w({__name:"index",setup(m){return S({title:"АГА. Формы собственностей"}),(r,n)=>(h(),g(Y))}});export{pe as default};
