import{u as D}from"./vue.f36acd1f.ee4e5a38.js";import{_ as H}from"./nuxt-link.6c446591.js";import{u as M}from"./useData.cb5eebf3.js";import{a as B}from"./company.44139364.js";import{_ as F,a as R}from"./ModerationPopup.vue.667f8847.js";import{f as k,r as l,o as r,c as _,a as s,b as f,w as h,d as b,t as x,u as o,F as g,i as V,g as $,k as j}from"./entry.676b6978.js";import"./cookie.5691c368.js";import"./Popup.vue.9460c2dc.js";import"./icon-close.c49ccc36.js";import"./PopupContainer.54ccd51c.js";const E={class:"border-b-[3px] mb-4"},O={class:"flex w-full border-b border-b-main"},q={class:"inline-block bg-second text-white text-xs rounded-lg px-2"},A={class:"inline-block bg-second text-white text-xs rounded-lg px-2"},I={key:0,class:"my-4"},z={key:1},G=s("h3",{class:"text-2xl"},"Нет, инициатив в очереди для модерации",-1),J=[G],K={class:"mb-4"},P=["innerHTML"],Q=["innerHTML"],U={key:0,class:"bg-red-600 text-white text-sm px-4 rounded"},W=k({__name:"Moderation",props:{mode:String},setup(w){const a=M(),n=l(a.companies||[]),C=l(a.initiatives||[]),v=l(""),m=l(""),y=l(""),c=l(),S=Object(B);let i;const T=p=>{var d;if(!c.value||typeof n.value>"u")return;i=p;const e=n.value.find(t=>t.id===p);if(e){m.value=e.declineReason?e.declineReason:"";let t="";e.contacts&&e.contacts.forEach(u=>{t+=`${S[u.type]}: ${u.value}
`}),v.value=`${e.requsites}`,y.value=t,c.value.popupOpen(`${e.nameShort} (${(d=e.ownership)==null?void 0:d.nameShort} «${e.nameFull}»)`)}},L=async()=>{i&&await a.approveCompany(i)&&(i=0,n.value=a.companies,console.log(n.value.length))},N=async()=>{if(!i)return;const p=(c==null?void 0:c.value.getReason())||"";await a.declineCompany(i,p)&&(i=0,n.value=a.companies)};return(p,e)=>{const d=H;return r(),_(g,null,[s("div",E,[s("div",O,[f(d,{class:"py-3 px-6 rounded-tl rounded-tr bg-main text-white"},{default:h(()=>[b(" Компании "),s("span",q,x(o(n).length),1)]),_:1}),f(d,{href:"/client/moderation/initiatives",class:"py-3 px-6 rounded-tl rounded-tr text-main hover:bg-main/10"},{default:h(()=>[b(" Инициативы "),s("span",A,x(o(C).length),1)]),_:1})])]),o(n).length?(r(),_("div",I,[(r(!0),_(g,null,V(o(n),t=>{var u;return r(),$(F,{key:t.id,id:t.id,title:`${t.nameShort}`,text:`${(u=t.ownership)==null?void 0:u.nameShort} «${t.nameFull}»`,onClick:T},null,8,["id","title","text"])}),128))])):(r(),_("div",z,J)),f(R,{ref_key:"popup",ref:c,onApprove:L,onDecline:N},{default:h(()=>[s("div",K,[s("div",{class:"text-lg text-gray-700 mb-2",innerHTML:o(v).split(`
`).join("<br />")},null,8,P),s("div",{class:"italic text-gray-500 mb-2",innerHTML:o(y).split(`
`).join("<br />")},null,8,Q),o(m)?(r(),_("div",U,x(o(m)),1)):j("",!0)])]),_:1},512)],64)}}}),re=k({__name:"index",setup(w){return D({title:"АГА. Модерация списка компаний"}),(a,n)=>(r(),$(W))}});export{re as default};
