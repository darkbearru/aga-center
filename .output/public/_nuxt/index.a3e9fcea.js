import{u as B}from"./vue.f36acd1f.ee4e5a38.js";import{_ as C}from"./nuxt-link.6c446591.js";import{u as L}from"./useData.cb5eebf3.js";import{_ as R,a as T}from"./ModerationPopup.vue.667f8847.js";import{_ as V}from"./PhotosList.vue.f540a820.js";import{f as k,r as c,o as a,c as d,a as t,b as u,w as x,d as g,t as v,u as i,F as y,i as H,g as w,k as M}from"./entry.676b6978.js";import"./cookie.5691c368.js";import"./Popup.vue.9460c2dc.js";import"./icon-close.c49ccc36.js";import"./PopupContainer.54ccd51c.js";import"./nuxt-img.ced04cb3.js";import"./icon-trash.903a0f0f.js";import"./icon-restore.f3d8e6a1.js";const F={class:"border-b-[3px] mb-4"},j={class:"flex w-full border-b border-b-main"},A={class:"inline-block bg-second text-white text-xs rounded-lg px-2"},E={class:"inline-block bg-second text-white text-xs rounded-lg px-2"},O={key:0,class:"my-4"},S={key:1},q=t("h3",{class:"text-2xl"},"Нет, инициатив в очереди для модерации",-1),z=[q],G={class:"mb-4"},J=["innerHTML"],K={class:"text-gray-500 mb-2"},P={key:0,class:"bg-red-600 text-white text-sm px-4 rounded"},Q=k({__name:"ModerationInitiative",setup($){const n=L(),h=c(n.companies||[]),s=c(n.initiatives||[]),b=c(""),m=c(""),r=c(),f=c();let o;const I=l=>{if(!r.value||typeof s.value>"u")return;o=l;const e=s.value.find(p=>p.id===l);e&&(m.value=e.declineReason?e.declineReason:"",b.value=`${e.text}`,r.value.popupOpen(`${e.name}`),f.value&&f.value.update((e==null?void 0:e.photos)||[]))},D=async()=>{o&&await n.approveInitiative(o)&&(o=0,s.value=n.initiatives)},N=async()=>{if(!o)return;const l=(r==null?void 0:r.value.getReason())||"";await n.declineInitiative(o,l)&&(o=0,s.value=n.initiatives)};return(l,e)=>{const p=C;return a(),d(y,null,[t("div",F,[t("div",j,[u(p,{href:"/client/moderation",class:"py-3 px-6 rounded-tl rounded-tr text-main hover:bg-main/10"},{default:x(()=>[g(" Компании "),t("span",A,v(i(h).length),1)]),_:1}),u(p,{class:"py-3 px-6 rounded-tl rounded-tr bg-main text-white"},{default:x(()=>[g(" Инициативы "),t("span",E,v(i(s).length),1)]),_:1})])]),i(s).length?(a(),d("div",O,[(a(!0),d(y,null,H(i(s),_=>(a(),w(R,{key:_.id,id:_.id,title:`${_.name}`,text:`${_.text.substring(0,50)}...`,onClick:I},null,8,["id","title","text"]))),128))])):(a(),d("div",S,z)),u(T,{ref_key:"popup",ref:r,onApprove:D,onDecline:N},{default:x(()=>[t("div",G,[t("div",{class:"text-lg text-gray-700 mb-2",innerHTML:i(b).split(`
`).join("<br />")},null,8,J),t("div",K,[u(V,{photos:[],ref_key:"photos",ref:f,moderation:!1},null,512)]),i(m)?(a(),d("div",P,v(i(m)),1)):M("",!0)])]),_:1},512)],64)}}}),ce=k({__name:"index",setup($){return B({title:"АГА. Модерация списка инициатив"}),(n,h)=>(a(),w(Q))}});export{ce as default};
